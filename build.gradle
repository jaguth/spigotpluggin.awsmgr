buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.1'
    }
}

apply plugin: 'java'

// for fat jar
apply plugin: 'com.github.johnrengelman.shadow'

group 'com.jaguth'
version '1.1'

sourceCompatibility = 1.8

repositories {
    mavenCentral()

    maven {
        url 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/'
    }
    maven {
        url 'https://hub.spigotmc.org/nexus/content/groups/public/' // dependencies required by org.spigotmc:spigot-api:1.14-R0.1-SNAPSHOT
    }
}

dependencies {
    compile 'org.spigotmc:spigot-api:1.14.2-R0.1-SNAPSHOT' // from https://hub.spigotmc.org/nexus/content/repositories/snapshots/

    compile 'com.amazonaws:aws-java-sdk-ec2:1.11.505'
    compile 'com.amazonaws:aws-java-sdk-sts:1.11.505'
    compile 'com.amazonaws:aws-java-sdk-sqs:1.11.505'

    testCompile 'junit:junit:4.12'
    testCompile 'org.mockito:mockito-core:2.+'
    testCompile 'org.powermock:powermock-module-junit4:2.0.0'//
    testCompile 'org.powermock:powermock-api-mockito2:2.0.0'
}

// convenience methods for myself
task deleteFromSpigotServer(type: Delete) {
    delete "../../localbin/spigotServer/plugins/spigotpluggin.awsmgr-1.1-all.jar"
    followSymlinks = true
}
deleteFromSpigotServer.group = 'custombuild'
deleteFromSpigotServer.dependsOn shadowJar

task buildAndCopyToSpigotServer(type: Copy) {
    from file("$buildDir/libs/spigotpluggin.awsmgr-1.1-all.jar")
    into file("../../localbin/spigotServer/plugins")
}
buildAndCopyToSpigotServer.dependsOn deleteFromSpigotServer
buildAndCopyToSpigotServer.group = 'custombuild'
